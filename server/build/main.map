{"version":3,"sources":["webpack:///webpack/bootstrap 4f20627b96f80ff3fb59","webpack:///external \"express\"","webpack:///external \"mongoose\"","webpack:///./src/index.js","webpack:///external \"cors\"","webpack:///external \"volleyball\"","webpack:///./src/routes/cine.js","webpack:///./src/models/Movie.js","webpack:///external \"multer\""],"names":["port","process","env","PORT","app","express","mongoose","connect","db","connection","on","console","error","bind","once","log","use","cors","listen","storage","multer","diskStorage","destination","req","file","cb","filename","fieldname","Date","now","upload","cineRouter","Router","post","single","res","newMovie","body","img","save","err","movie","redirect","get","Movie","find","films","send","json","_id","params","id","findOneAndUpdate","delete","message","Schema","movieSchema","title","type","String","required","year","Number","actors","Array","kind","model"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 4f20627b96f80ff3fb59","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 0\n// module chunks = 0","module.exports = require(\"mongoose\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongoose\"\n// module id = 1\n// module chunks = 0","import express from \"express\"\nimport mongoose from \"mongoose\"\nimport cors from \"cors\"//pb header\nimport volleyball from \"volleyball\"\n const port = process.env.PORT || 5679\nimport cineRouter from \"./routes/cine\"\n//\nconst app = express()\n//\n//config mongoose\nmongoose.connect('mongodb://localhost:27017/cine_db');\nvar db = mongoose.connection;\ndb.on('error', console.error.bind(console, 'connection error:'));\ndb.once('open', function() {\n  console.log(`[MongoDB] connected`);\n});\n//\napp.use(volleyball)\napp.use(cors())\napp.use('/cine', cineRouter)\n\n\n\napp.listen(port, () => {\n  console.log(`[Express] running on port : ${port}`);\n})\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","module.exports = require(\"cors\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"cors\"\n// module id = 4\n// module chunks = 0","module.exports = require(\"volleyball\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"volleyball\"\n// module id = 5\n// module chunks = 0","import express from \"express\"\nimport Movie from '../models/Movie'\nimport multer from \"multer\"\n\n//config multer\nconst storage = multer.diskStorage({\n  destination: function( req, file, cb){\n    cb(null, '../public')\n  },\nfilename: function(req, file, cb){\n  cb(null, file.fieldname + '-' + Date.now())\n}\n});\n\nconst upload = multer({storage: storage})\n\n\nconst cineRouter = express.Router()\n\ncineRouter.post('/add', upload.single('img'), (req, res) => {\n  const newMovie = new Movie(req.body)\n  newMovie.img = req.file.filename\n  newMovie.save((err, movie) => {\n    if(err) return console.log(err)\n    res.redirect(\"http://localhost:3000/\")\n  })\n})\n\ncineRouter.get('/', (req, res) => {\n  Movie.find({}, (err, films) => {\n    if(err) res.send(err)\n    res.json(films)\n  })\n})\n\ncineRouter.get('/:id', (req, res) => {//c'est un paramètre id: l'id qu'on rentre ici doit correspondre à celui qu'on find dans notre base de données\n  Movie.find({_id: req.params.id}, (err, movie) => {\n    if(err) res.send(err)\n    res.json(movie)\n  })\n})\n\ncineRouter.post('/:id', (req, res) => {//une sorte de put (car il marche pas avec un formulaire html)\n  Movie.findOneAndUpdate({_id: req.params.id}, req.body, (err, movie) => {\n    if(err) res.send(err)\n    res.json(movie)\n  })\n})\n\ncineRouter.delete('/:id', (req, res) => {\n  Movie.delete({_id: req.params.id}, (err, movie) => {\n    if(err) res.send(err)\n    res.json({message: \"y'a plus\"})\n  })\n})\n\nexport default cineRouter\n\n\n\n// WEBPACK FOOTER //\n// ./src/routes/cine.js","import mongoose from \"mongoose\"\nconst Schema = mongoose.Schema\n\nconst movieSchema = new Schema({\n  title: {type:String, required:true},\n  year: {type:Number, required:true},\n  actors: {type:Array, required:true},\n  kind: {type: String, required:true},\n  img: {type: String, required: true}\n})\n\nexport default mongoose.model(\"Movie\", movieSchema)\n\n\n\n// WEBPACK FOOTER //\n// ./src/models/Movie.js","module.exports = require(\"multer\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"multer\"\n// module id = 8\n// module chunks = 0"],"sourceRoot":""}